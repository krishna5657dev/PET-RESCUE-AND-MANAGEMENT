
{% extends "User1/header_adm.html" %}
{% block content %}
{% load static %}


		<div id="page-wrapper">
			<div class="main-page">
				<div class="forms">

					<h3 class="title1">District</h3>
                    <div class="col-sm-6"  style="min-height:500px;">
                        {% if messages %}
                        <ul class="messages">
                            {% for message in messages %}
                          <div class="alert alert-success"> {{message }}</div>
                            {% endfor %}
                        </ul>
                        {% endif %}
					

						<div class="form-container" style="max-width: 500px; margin: 20px auto; padding: 20px; border: 1px solid #ddd; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); background-color: #f9f9f9;">
              <h2 style="text-align: center; margin-bottom: 20px;">Add District</h2>
              <div class="form-body">
                  <form action="/add_district/" method="post" id="myform">
                      {% csrf_token %}
                      
                      <div class="form-group">
                          <label for="country">Country</label>
                          <select name="country" id="country" class="form-control" required>
                              <option value="">--Select--</option>
                              {% for k in data1 %}
                                  <option value="{{ k.country_id }}">{{ k.country }}</option>
                              {% endfor %}
                          </select>
                      </div>
          
                      <div class="form-group">
                          <label for="state">State</label>
                          <select name="state" id="state" class="form-control" required>
                              <option value="">--Select--</option>
                              <!-- Options will be populated based on selected country -->
                          </select>
                      </div>
          
                      <div class="form-group">
                          <label for="district">District</label>
                          <input type="text" class="form-control" id="district" placeholder="Enter district name" name="district" required>
                      </div>
          
                      <div class="text-center" style="margin-top: 20px;">
                          <button type="submit" class="btn btn-primary" style="padding: 10px 20px; border: none; border-radius: 5px; background-color: #5254B1; color: white; cursor: pointer;">Submit</button>
                      </div>
                  </form>
              </div>
          </div>
          

                                <script src="{% static 'assets/Validation/jquery_validate.js' %}"></script>
                                <script src="{% static 'assets/Validation/additional_validate.js' %}"></script>
                                <script>

							$("#country").change(function () {
							   var country = $(this).val();

							   $.ajax({

									 url: '/display_state/',
									 data: {
										 'country_id': country
									 },
									 dataType: 'json',
									 success: function (data) {


                                        let html_data = '<option value="">--Select--</option>';
                data.forEach(function (data) {
                    html_data += `<option value="${data.state_id}">${data.state}</option>`
                });
                $("#state").html(html_data);



									 }
							   });

							});
						 </script>
        <script>
            (function ($, W, D)
          {
          var JQUERY4U = {};
          JQUERY4U.UTIL =
              {
                  setupFormValidation: function ()
                  {
                    $.validator.addMethod(
            "regex",
            function(value, element, regexp) {
                var check = false;
                return this.optional(element) || regexp.test(value);
            },
            "Not a valid Input."
        );

                  //form validation rules
                  $("#myform").validate({
                    rules: {
                                        country: {
                                          required: true,

                                        },
                                        state: {
                                          required: true,


                                        },
                                        district: {
                                          required: true,
                                          regex :/^[a-zA-Z ]+$/,

                                        },

                                      },
                                      messages: {



                      },
                      submitHandler: function (form) {
                      form.submit();
                      }
                  });
                }
              }
          //when the dom has loaded setup form validation rules
          $(D).ready(function ($) {
              JQUERY4U.UTIL.setupFormValidation();
          });
          })(jQuery, window, document);
        </script>
						</div>
					</div>
                </div>
					<div class="col-sm-6" style="margin-top: 10px;">
            <div class="form-title">
							<h4>State List :</h4>
						</div>

            <table class="table table-striped table-bordered">
              <thead><th>Id</th><th>Country</th><th>State</th><th>District</th><th>#</th><th>#</th></thead>

              {%  for k in data  %}

                <tr>


                      <td>{{forloop.counter}}</td>
                      <td>{{k.0}}</td>
                      <td>{{k.1}}</td>
                      <td>{{k.3}}</td>
                      <td><a href="/edit_district/{{k.2}}" class="btn btn-info">Edit</a></td>
                      <td><a href="/delete_district/{{k.2}}" onclick="return ConfirmDialog();" class="btn btn-danger">Delete</a></td>
                  </tr>

                  {% endfor  %}
            </table>
					</div>
					<div class="row">

				</div>
			</div>
		</div>
		<!--footer-->
        {% endblock %}